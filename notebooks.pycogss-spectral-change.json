{"version":2,"kind":"Notebook","sha256":"c5effcf88365ba3ec6684ed05a02d7dbba22198046774527217a9676acc12731","slug":"notebooks.pycogss-spectral-change","location":"/notebooks/05_pycogss_spectral_change.ipynb","dependencies":[],"frontmatter":{"title":"Use the GeoJSON file to get the Area of Interest and query the STAC catalog for items","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Harsha R. Hampapura","given":"Harsha R.","family":"Hampapura"},"name":"Harsha R. Hampapura","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Brian Bockelman","given":"Brian","family":"Bockelman"},"name":"Brian Bockelman","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Alexander Hoelzeman","given":"Alexander","family":"Hoelzeman"},"name":"Alexander Hoelzeman","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Emma Turetsky","given":"Emma","family":"Turetsky"},"name":"Emma Turetsky","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Amandha Wingert Barok","given":"Amandha Wingert","family":"Barok"},"name":"Amandha Wingert Barok","id":"contributors-myst-generated-uid-4"},{"nameParsed":{"literal":"Aashish Panta","given":"Aashish","family":"Panta"},"name":"Aashish Panta","id":"contributors-myst-generated-uid-5"},{"nameParsed":{"literal":"Riley Conroy","given":"Riley","family":"Conroy"},"name":"Riley Conroy","id":"contributors-myst-generated-uid-6"},{"nameParsed":{"literal":"Douglas Schuster","given":"Douglas","family":"Schuster"},"name":"Douglas Schuster","id":"contributors-myst-generated-uid-7"},{"nameParsed":{"literal":"Justin Hiemstra","given":"Justin","family":"Hiemstra"},"name":"Justin Hiemstra","id":"contributors-myst-generated-uid-8"},{"nameParsed":{"literal":"Kibiwott Koech","given":"Kibiwott","family":"Koech"},"name":"Kibiwott Koech","id":"contributors-myst-generated-uid-9"}],"open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true},"code":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/osdf-cookbook","copyright":"2024","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/osdf-cookbook/blob/main/notebooks/05_pycogss_spectral_change.ipynb","exports":[{"format":"ipynb","filename":"05_pycogss_spectral_change.ipynb","url":"/osdf-cookbook/build/05_pycogss_spectral_-77da3975b920cc7746d28d101a2572ca.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Imports\nimport matplotlib.pyplot as plt\nimport numpy as np\nimport pandas as pd\nimport xarray as xr\nimport re\nfrom pelicanfs.core import PelicanFileSystem, PelicanMap,OSDFFileSystem \nimport geopandas as gpd\nfrom pystac_client import Client\nfrom rasterio.mask import mask\nimport rasterio\nfrom shapely.geometry import box\nfrom urllib.parse import urlparse","key":"yGfeBXvI3i"},{"type":"output","id":"UtyAyuP2fISTGfxQkck8i","data":[],"key":"ZkmRKn7WH0"}],"key":"YVAvzCh9ue"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use the GeoJSON file to get the Area of Interest and query the STAC catalog for items","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CoCBWrFBFf"}],"identifier":"use-the-geojson-file-to-get-the-area-of-interest-and-query-the-stac-catalog-for-items","label":"Use the GeoJSON file to get the Area of Interest and query the STAC catalog for items","html_id":"use-the-geojson-file-to-get-the-area-of-interest-and-query-the-stac-catalog-for-items","implicit":true,"key":"sO4RIjqbIK"}],"key":"KgaeHytarU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Load the GeoJSON file\ngeojson_path = '3100180240.geojson' \ngdf = gpd.read_file(geojson_path)\n\n# Display the loaded GeoDataFrame\nprint(gdf)","key":"YnpRHrWh94"},{"type":"output","id":"vOC6lrj0q2PyVH8bMpQtA","data":[{"output_type":"stream","name":"stdout","text":"                     id  SUB_AREA  COAST     PFAF_ID  DIST_MAIN    HYBAS_ID  \\\n0  00140000000000002983     128.1      0  3512704524      784.3  3100180240   \n\n   DIST_SINK   NEXT_DOWN  ORDER  ENDO    MAIN_BAS   NEXT_SINK   SORT  UP_AREA  \\\n0      784.3  3100180230      4     0  3100009670  3100009670  66318    128.1   \n\n                                            geometry  \n0  POLYGON ((134.51667 66.87917, 134.51752 66.875...  \n"}],"key":"YHnhpgBNfV"}],"key":"j6GEOE3gdB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Extract AOI geometry\naoi_geometry = gdf.geometry.iloc[0]\naoi_bounds   = aoi_geometry.bounds  # (minx, miny, maxx, maxy)\n\n# Get AOI centroid for visualization\ncentroid  = aoi_geometry.centroid\nlong, lat = centroid.x, centroid.y\n\n# Print the bounding box to verify\nprint(\"Bounding Box:\", aoi_bounds)","key":"feqLOj69Gw"},{"type":"output","id":"cbdxCoP6siZPruGEzr_81","data":[{"output_type":"stream","name":"stdout","text":"Bounding Box: (134.51666686838126, 66.7708333115583, 134.9046488751149, 66.97083294070578)\n"}],"key":"i86t2mshvZ"}],"key":"Xr1kGfwozD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Connect to the Earth Search STAC API (Sentinel-2 Level-2A COGs are available here)\ncatalog_url = \"https://earth-search.aws.element84.com/v1\"\ncatalog     = Client.open(catalog_url)\n\n# Define the date range as strings\nstart_date      = \"2019-01\"\nend_date        = \"2023-02\"\n\n# Define cloud cover threshold\ncloud_cover_max = 0.05  # 5% cloud cover threshold\n#cloud_cover_max = 0.20  # 20% cloud cover threshold\n\n# Perform the search\nsearch = catalog.search(\n                 collections=[\"sentinel-2-l2a\"],\n                 bbox=aoi_bounds,\n                 datetime=f\"{start_date}/{end_date}\",\n                 #datetime=\"2022-06-01/2022-09-30\",\n                 query={\"eo:cloud_cover\": {\"lt\": cloud_cover_max * 100}}\n                )\n\n# Get all matching items\nitems = list(search.items())\nprint(f\"Found {len(items)} matching items.\")","key":"jebIi8FpOP"},{"type":"output","id":"6HaKLCo3KS2djFglzNHhj","data":[{"output_type":"stream","name":"stdout","text":"Found 258 matching items.\n"}],"key":"YUHY8Nq1k3"}],"key":"U9yuiN95aL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Confirm that the matching items are hosted in a aws-us-region by printing out the href links for the first n items\nn=1\n\nfor i, item in enumerate(items[:n]):\n    print(f\"\\nItem {i+1}: {item.id}\")\n    for asset_key, asset in item.assets.items():\n        print(f\"  {asset_key}: {asset.href}\")","key":"ab5qgnkw3K"},{"type":"output","id":"sM493EO4FKUWwpyN71rt5","data":[{"output_type":"stream","name":"stdout","text":"\nItem 1: S2B_53WMQ_20230222_0_L2A\n  aot: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/AOT.tif\n  blue: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B02.tif\n  coastal: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B01.tif\n  granule_metadata: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/granule_metadata.xml\n  green: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B03.tif\n  nir: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B08.tif\n  nir08: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B8A.tif\n  nir09: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B09.tif\n  red: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B04.tif\n  rededge1: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B05.tif\n  rededge2: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B06.tif\n  rededge3: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B07.tif\n  scl: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/SCL.tif\n  swir16: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B11.tif\n  swir22: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/B12.tif\n  thumbnail: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/thumbnail.jpg\n  tileinfo_metadata: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/tileinfo_metadata.json\n  visual: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/TCI.tif\n  wvp: https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/53/W/MQ/2023/2/S2B_53WMQ_20230222_0_L2A/WVP.tif\n  aot-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/AOT.jp2\n  blue-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B02.jp2\n  coastal-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B01.jp2\n  green-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B03.jp2\n  nir-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B08.jp2\n  nir08-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B8A.jp2\n  nir09-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B09.jp2\n  red-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B04.jp2\n  rededge1-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B05.jp2\n  rededge2-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B06.jp2\n  rededge3-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B07.jp2\n  scl-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/SCL.jp2\n  swir16-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B11.jp2\n  swir22-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/B12.jp2\n  visual-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/TCI.jp2\n  wvp-jp2: s3://sentinel-s2-l2a/tiles/53/W/MQ/2023/2/22/0/WVP.jp2\n"}],"key":"Vl95hncCBr"}],"key":"apG0k8xCzv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from shapely.geometry import mapping\n\n# Reproject AOI to match raster CRS\nfrom pyproj import CRS\nfrom geopandas import GeoSeries","key":"aXsmVlcQhN"},{"type":"output","id":"I8_piOpRMVR6j-eAeInXc","data":[],"key":"zI79M5Jrj2"}],"key":"v1hPMncllW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def returnOSDFPath(url):\n    \"\"\"\n    Converts a URL to an OSDF path.\n\n    Parameters:\n    - url: URL to convert.\n\n    Returns:\n    - OSDF path.\n    \"\"\"\n    # Parse the URL\n    parsed_url = urlparse(url)\n    \n    # Construct the OSDF path\n    osdf_path = f\"/aws-opendata/us-west-2/sentinel-cogs{parsed_url.path}\"\n    \n    return osdf_path\n","key":"r4lHbarsfH"},{"type":"output","id":"7HXubpybsyLgfirlh3Z1z","data":[],"key":"tfImU93L0q"}],"key":"Ia2DEE3IdK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Apply various masks and calculate NDVI","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sHFdkwxI0e"}],"identifier":"apply-various-masks-and-calculate-ndvi","label":"Apply various masks and calculate NDVI","html_id":"apply-various-masks-and-calculate-ndvi","implicit":true,"key":"Fdz1Hpr2aU"}],"key":"xDbMeCU386"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def clp(image_src, aoi_geometry):\n    \"\"\"\n    Clip a raster image to the Area of Interest (AOI).\n\n    Parameters:\n    - image_src: Open rasterio dataset.\n    - aoi_geometry: AOI geometry as a GeoJSON-like object.\n\n    Returns:\n    - Clipped image array and updated metadata.\n    \"\"\"\n    # out_image, out_transform = mask(image_src, [aoi_geometry], crop=True)\n    out_image, out_transform = mask(image_src, aoi_geometry, crop=True)\n    out_meta = image_src.meta.copy()\n    out_meta.update({\n        \"driver\": \"GTiff\",\n        \"height\": out_image.shape[1],\n        \"width\": out_image.shape[2],\n        \"transform\": out_transform\n    })\n    return out_image, out_meta\n\ndef maskWater(image, water_mask):\n    \"\"\"\n    Masks out water pixels using the MODIS water mask.\n\n    Parameters:\n    - image: Raster image to mask.\n    - water_mask: Water mask raster.\n\n    Returns:\n    - Water-masked image.\n    \"\"\"\n    water = water_mask.read(1)  # Read the water mask\n    mask = water < 1  # Mask water pixels (water < 1)\n    image_masked = np.where(mask, image, np.nan)\n    return image_masked\n\ndef maskS2snow(image, snow_prob):\n    \"\"\"\n    Masks snow pixels using the MSK_SNWPRB (Snow Probability Mask).\n\n    Parameters:\n    - image: Raster image to mask.\n    - snow_prob: Snow probability raster.\n\n    Returns:\n    - Snow-masked image.\n    \"\"\"\n    snow = snow_prob.read(1)  # Read the snow probability mask\n    mask = snow < 0.009  # Mask snow pixels (snow probability < 0.9%)\n    image_masked = np.where(mask, image, np.nan)\n    return image_masked\n\ndef maskWhite(image, b2, b3, b4):\n    \"\"\"\n    Masks white pixels by converting RGB to grayscale and applying a threshold.\n\n    Parameters:\n    - image: Raster image to mask.\n    - b2, b3, b4: Blue, Green, and Red bands respectively.\n\n    Returns:\n    - Grayscale-masked image.\n    \"\"\"\n    # Convert RGB to grayscale\n    grayscale = (0.3 * b4.read(1) + 0.59 * b3.read(1) + 0.11 * b2.read(1)) * 1e4\n    mask = grayscale <= 2000  # Mask white pixels (grayscale > 2000)\n    image_masked = np.where(mask, image, np.nan)\n    return image_masked","key":"COUGxsqCQa"},{"type":"output","id":"pk8y8jFxn6qK9NvmJ8-pH","data":[],"key":"spHNerEygy"}],"key":"xKCUW89duk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# # Using pelicanfs\n# Loop through each item in the STAC query\nfor idx, item in enumerate(items, start=1):\n    print(f\"Processing dataset #{idx}\")\n    if idx == 6: # Otherwise \n        break\n\n    # Check required assets\n    required_assets = [\"red\", \"green\", \"blue\", \"scl\"]\n    if not all(asset in item.assets for asset in required_assets):\n        print(f\"Skipping dataset #{idx}: Missing required assets.\")\n        continue\n\n    # Get asset URLs\n    red_url = item.assets[\"red\"].href\n    green_url = item.assets[\"green\"].href\n    blue_url = item.assets[\"blue\"].href\n    scl_url = item.assets[\"scl\"].href\n\n    pel_red_url   = returnOSDFPath(red_url)\n    pel_green_url = returnOSDFPath(green_url)\n    pel_blue_url  = returnOSDFPath(blue_url)\n    pel_scl_url   = returnOSDFPath(scl_url)\n\n    pelfs = PelicanFileSystem(\"pelican://osg-htc.org\")\n\n    # Reproject AOI to match raster CRS\n    with rasterio.open(pel_red_url,opener=pelfs) as src:\n        raster_crs = CRS(src.crs)\n    aoi_geometry_reprojected = GeoSeries(aoi_geometry).set_crs(gdf.crs).to_crs(raster_crs)\n\n    # Reproject AOI to match raster CRS\n    with rasterio.open(pel_red_url, opener=pelfs) as red_src, \\\n         rasterio.open(pel_green_url, opener=pelfs) as green_src, \\\n         rasterio.open(pel_blue_url, opener=pelfs) as blue_src, \\\n         rasterio.open(pel_scl_url, opener=pelfs) as scl_src:\n\n        aoi_geometry_reprojected = GeoSeries(aoi_geometry).set_crs(gdf.crs).to_crs(raster_crs)\n        raster_bounds = box(*red_src.bounds)\n\n        if not aoi_geometry_reprojected[0].intersects(raster_bounds):\n            print(f\"Warning: AOI does not intersect the bounds of {red_url}. Skipping.\")\n            continue\n\n        # Clip all RGB and SCL bands to AOI\n        red_clipped, red_meta = clp(red_src, aoi_geometry_reprojected)\n        green_clipped, _      = clp(green_src, aoi_geometry_reprojected)\n        blue_clipped, _       = clp(blue_src, aoi_geometry_reprojected)\n        scl_clipped, _        = clp(scl_src, aoi_geometry_reprojected)\n\n        print(f\"Dataset #{idx} processed. Ready for visualization or further analysis.\")","key":"aa0LNlxpPM"},{"type":"output","id":"FZ7_e9m8pkJUTJIwUZtQ0","data":[{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Processing dataset #1\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Dataset #1 processed. Ready for visualization or further analysis.\nProcessing dataset #2\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Dataset #2 processed. Ready for visualization or further analysis.\nProcessing dataset #3\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Dataset #3 processed. Ready for visualization or further analysis.\nProcessing dataset #4\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Dataset #4 processed. Ready for visualization or further analysis.\nProcessing dataset #5\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stderr","text":"Discovery URL pelican://osg-htc.org/ does not match pelican://test/\n"},{"output_type":"stream","name":"stdout","text":"Dataset #5 processed. Ready for visualization or further analysis.\nProcessing dataset #6\nCPU times: user 5.25 s, sys: 787 ms, total: 6.04 s\nWall time: 4min 40s\n"}],"key":"zej9J9FSy5"}],"key":"OFeMNpqO3G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from sklearn.preprocessing import MinMaxScaler\n# Function to scale image bands properly\ndef scale_band(band):\n    scaler = MinMaxScaler(feature_range=(0, 1))\n    return scaler.fit_transform(band)  # Normalize between 0-1\n\n# Assuming red_clipped, green_clipped, and blue_clipped are 2D NumPy arrays\nrgb = np.dstack((scale_band(red_clipped.squeeze()),\n    scale_band(green_clipped.squeeze()),\n    scale_band(blue_clipped.squeeze()),\n))\n\n# Plot\nplt.figure(figsize=(10, 8))\nplt.imshow(rgb)\nplt.axis(\"off\")\nplt.show()","key":"iCSgeXKQ9f"},{"type":"output","id":"yZR-kb7YzzZRfVi9lQ_vV","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1000x800 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ff6290951a21c65850fa9b71dfec0215","path":"/osdf-cookbook/build/ff6290951a21c65850fa9b71dfec0215.png"}}}],"key":"RXJJwB1lQd"}],"key":"CBKuOVFTEg"}],"key":"zqeu64vRrD"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Project Pythia - Sonar AI ... Integrating sonar and buoy-based temperature data","url":"/notebooks/foundations","group":"NOAA SONAR data examples"},"next":{"title":"Introduction to NSDF-OpenVISUS","url":"/notebooks/introduction-to-nsdf-openvisus","group":"OpenVISUS examples"}}},"domain":"http://localhost:3000"}